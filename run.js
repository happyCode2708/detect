let result =
  '## Nutrition Fact for Hard Agua Fresca / Mango [1]\n| Nutrient Name  | Amount per Serving | % Daily Value | parentheses descriptor (nullable) | blend ingredients (if nutrient is a blend/mix)  (nullable) | symbol |\n| ------- | -------- | -------- | -------- | -------- | -------- |\n| Total Fat | 0g | 0% |  |  |  |\n| Sodium | 10mg | 0% |  |  |  |\n| Total Carbohydrate | 11g | 4% |  |  |  |\n| Total Sugars | 10g |  |  |  |  |\n| Added Sugars | 5g | 10% | Includes |  |  |\n| Protein | 0g | 0% |  |  |  |\n| Vitamin C | 4mg | 4% |  |  |  |\n\n## Footnote [1]\n| footnote symbol (nullable) | footnote content at bottom of nutrition fact (nullable) |\n| ------- | -------- |\n|  | Not a significant source of saturated fat, trans fat, cholesterol, dietary fiber, vitamin D, potassium, calcium or iron. |\n\n## Nutrition Fact for Chili Lime Salt Mix [2]\n| Nutrient Name  | Amount per Serving | % Daily Value | parentheses descriptor (nullable) | blend ingredients (if nutrient is a blend/mix)  (nullable) | symbol |\n| ------- | -------- | -------- | -------- | -------- | -------- |\n| Total Fat | 0g | 0% |  |  |  |\n| Sodium | 784mg | 33% |  |  |  |\n| Total Carbohydrate | 2g | 1% |  |  |  |\n| Total Sugars | 1g |  |  |  |  |\n| Protein | 0g | 0% |  |  |  |\n\n## Footnote [2]\n| footnote symbol (nullable) | footnote content at bottom of nutrition fact (nullable) |\n| ------- | -------- |\n|  | Not a significant source of saturated fat, trans fat, cholesterol, dietary fiber, vitamin D, calcium, iron and potassium. |\n';
let result_2 = `## Nutrition Fact for Nancy's Oatmilk Blueberry 1\n| Nutrient Name  | Amount per Serving | % Daily Value | parentheses descriptor (nullable) | blend ingredients (if nutrient is a blend/mix)  (nullable) | symbol |\n| ------- | -------- | -------- | -------- | -------- | -------- |\n| Calories | 140 |  |  |  |  |\n| Total Fat | 5g | 6% |  |  |  |\n| Saturated Fat | 3g | 15% |  |  |  |\n| Trans Fat | 0g |  |  |  |  |\n| Cholesterol | 0mg | 0% |  |  |  |\n| Sodium | 50mg | 2% |  |  |  |\n| Total Carbohydrate | 19g | 7% |  |  |  |\n| Dietary Fiber | 3g | 11% |  |  |  |\n| Total Sugars | 9g |  |  |  |  |\n| Added Sugars | 8g | 16% |  |  |  |\n| Protein | 4g | 8% |  |  |  |\n| Vitamin D | 0% |  |  |  |  |\n| Calcium | 4% |  |  |  |  |\n| Iron | 6% |  |  |  |  |\n| Potassium | 2% |  |  |  |  |\n\n## Footnote 1\n| footnote symbol (nullable) | footnote content at bottom of nutrition fact (nullable) |\n| ------- | -------- |\n|  | The % Daily Value (DV) tells you how much a nutrient in a serving of food contributes to a daily diet. 2,000 calories a day is used for general nutrition advice. |\n\n## Nutrition Fact for Nancy's Oatmilk Blueberry 2\n| Nutrient Name  | Amount per Serving | % Daily Value | parentheses descriptor (nullable) | blend ingredients (if nutrient is a blend/mix)  (nullable) | symbol |\n| ------- | -------- | -------- | -------- | -------- | -------- |\n| Calories | 140 |  |  |  |  |\n| Total Fat | 5g | 6% |  |  |  |\n| Saturated Fat | 3g | 15% |  |  |  |\n| Trans Fat | 0g |  |  |  |  |\n| Cholesterol | 0mg | 0% |  |  |  |\n| Sodium | 50mg | 2% |  |  |  |\n| Total Carbohydrate | 19g | 7% |  |  |  |\n| Dietary Fiber | 3g | 11% |  |  |  |\n| Total Sugars | 9g |  |  |  |  |\n| Added Sugars | 8g | 16% |  |  |  |\n| Protein | 4g | 8% |  |  |  |\n| Vitamin D | 0% |  |  |  |  |\n| Calcium | 4% |  |  |  |  |\n| Iron | 6% |  |  |  |  |\n| Potassium | 2% |  |  |  |  |\n\n## Footnote 2\n| footnote symbol (nullable) | footnote content at bottom of nutrition fact (nullable) |\n| ------- | -------- |\n|  | The % Daily Value (DV) tells you how much a nutrient in a serving of food contributes to a daily diet. 2,000 calories a day is used for general nutrition advice. |\n`;
let result_3 = `## Nutrition Fact for HARD AGUA FRESCA / MANGO 1\n| Nutrient Name | Amount per Serving | % Daily Value | parentheses descriptor | blend ingredients | symbol |\n|---|---|---|---|---|---|\n| Total Fat | 0g | 0% |  |  |  |\n| Sodium | 10mg | 0% |  |  |  |\n| Total Carbohydrate | 11g | 4% |  |  |  |\n| Total Sugars | 10g |  |  |  |  |\n| Added Sugars | 5g | 10% | included in \"Total Sugars\" |  |  |\n| Protein | 0g | 0% |  |  |  |\n| Vitamin C | 4mg | 4% |  |  |  |\n\n## Footnote 1\n| footnote symbol | footnote content at bottom of nutrition fact |\n|---|---|\n|  | Not a significant source of saturated fat, trans fat, cholesterol, dietary fiber, vitamin D, potassium, calcium or iron. |\n\n## Nutrition Fact for CHILI LIME SALT MIX 1\n| Nutrient Name | Amount per Serving | % Daily Value | parentheses descriptor | blend ingredients | symbol |\n|---|---|---|---|---|---|\n| Total Fat | 0g | 0% |  |  |  |\n| Sodium | 784mg | 33% |  |  |  |\n| Total Carbohydrate | 2g | 1% |  |  |  |\n| Total Sugars | 1g |  |  |  |  |\n| Protein | 0g | 0% |  |  |  |\n\n## Footnote 1\n| footnote symbol | footnote content at bottom of nutrition fact |\n|---|---|\n|  | Not a significant source of saturated fat, trans fat, cholesterol, dietary fiber, vitamin D, calcium, iron and potassium. |\n\n\n## Debug table\n| question | gemini answer |\n|---|---|\n| gemini answer me  how many nutrition fact tables from provided images? are they the same one ? | There are 2 nutrition fact tables in this image. They are not the same. |\n`;
let result_4 = `## Nutrition Fact for maple mustard [1]\n\n| Nutrient Name  | Amount per Serving | % Daily Value | parentheses descriptor (nullable) | blend ingredients (if nutrient is a blend/mix)  (nullable) | symbol |\n| ------- | -------- | -------- | -------- | -------- | -------- |\n| Calories | 70 |  |  |  |  |\n| Total Fat | 2.5g | 3% |  |  |  |\n| Saturated Fat | 0g | 0% |  |  |  |\n| Trans Fat | 0g |  |  |  |  |\n| Cholesterol | 0mg | 0% |  |  |  |\n| Sodium | 330mg | 14% |  |  |  |\n| Total Carb. | 14g | 5% |  |  |  |\n| Dietary Fiber | 1g | 4% |  |  |  |\n| Total Sugars | 8g |  |  |  |  |\n| Incl. Added Sugars | 6g | 12% |  |  |  |\n| Protein | 3g |  |  |  |  |\n| Vitamin D | 0.1mcg | 0% |  |  |  |\n| Calcium | 30mg | 2% |  |  |  |\n| Iron | 0.7mg | 4% |  |  |  |\n| Potassium | 460mg | 10% |  |  |  |\n| Thiamin | 0.12mg | 10% |  |  |  |\n| Riboflavin (Vitamin B₂) | 0.55mg | 40% |  |  |  |\n| Niacin (Vitamin B₃) | 4.7mg | 30% |  |  |  |\n| Vitamin B₆ | 0.12mg | 8% |  |  |  |\n| Vitamin B₁₂ | 0.09mcg | 4% |  |  |  |\n\n\n## Nutrition Fact for maple mustard [2]\n\n| Nutrient Name  | Amount per Serving | % Daily Value | parentheses descriptor (nullable) | blend ingredients (if nutrient is a blend/mix)  (nullable) | symbol |\n| ------- | -------- | -------- | -------- | -------- | -------- |\n| Calories | 150 |  |  |  |  |\n| Total Fat | 5g | 6% |  |  |  |\n| Saturated Fat | 0g | 0% |  |  |  |\n| Trans Fat | 0g |  |  |  |  |\n| Cholesterol | 0mg | 0% |  |  |  |\n| Sodium | 660mg | 29% |  |  |  |\n| Total Carb. | 29g | 11% |  |  |  |\n| Dietary Fiber | 2g | 7% |  |  |  |\n| Total Sugars | 16g |  |  |  |  |\n| Incl. Added Sugars | 12g | 24% |  |  |  |\n| Protein | 6g |  |  |  |  |\n| Vitamin D | 0.2mcg | 2% |  |  |  |\n| Calcium | 60mg | 4% |  |  |  |\n| Iron | 1.5mg | 8% |  |  |  |\n| Potassium | 940mg | 20% |  |  |  |\n| Thiamin | 0.24mg | 20% |  |  |  |\n| Riboflavin (Vitamin B₂) | 1.11mg | 90% |  |  |  |\n| Niacin (Vitamin B₃) | 9.5mg | 60% |  |  |  |\n| Vitamin B₆ | 0.24mg | 15% |  |  |  |\n| Vitamin B₁₂ | 0.19mcg | 8% |  |  |  |\n\n\n## Footnote [1]\n\n| footnote symbol (nullable) | footnote content at bottom of nutrition fact (nullable) |\n| ------- | -------- |\n| * | The % Daily Value (DV) tells you how much a nutrient in a serving of food contributes to a daily diet. 2,000 calories a day is used for general nutrition advice. |\n\n\n\n## Debug table\n| question | gemini answer |\n| ------- | -------- |\n| how many nutrition fact tables from provided images? are they the same one ? | 1, yes |\n `;
let result_5 = `# Nutrition Fact for maple mustard [1]\n| Nutrient Name  | Amount per Serving | % Daily Value | parentheses descriptor (nullable) | blend ingredients (if nutrient is a blend/mix)  (nullable) | symbol |\n| ------- | -------- | -------- | -------- | -------- | -------- |\n| Calories | 70 |  |  |  |  |\n| Total Fat | 2.5g | 3% |  |  |  |\n| Saturated Fat | 0g | 0% |  |  |  |\n| Trans Fat | 0g |  |  |  |  |\n| Cholesterol | 0mg | 0% |  |  |  |\n| Sodium | 330mg | 14% |  |  |  |\n| Total Carb. | 14g | 5% |  |  |  |\n| Dietary Fiber | 1g | 4% |  |  |  |\n| Total Sugars | 8g |  |  |  |  |\n| Added Sugars | 6g | 12% |  |  |  |\n| Protein | 3g |  |  |  |  |\n| Vitamin D | 0.1mcg | 0% |  |  |  |\n| Calcium | 30mg | 2% |  |  |  |\n| Iron | 0.7mg | 4% |  |  |  |\n| Potassium | 460mg | 10% |  |  |  |\n| Thiamin | 0.12mg | 10% |  |  |  |\n| Riboflavin (Vitamin B₂) | 0.55mg | 40% |  |  |  |\n| Niacin (Vitamin B₃) | 4.7mg | 30% |  |  |  |\n| Vitamin B₆ | 0.12mg | 8% |  |  |  |\n| Vitamin B₁₂ | 0.09mcg | 4% |  |  |  |\n\n# Nutrition Fact for maple mustard [2]\n| Nutrient Name  | Amount per Serving | % Daily Value | parentheses descriptor (nullable) | blend ingredients (if nutrient is a blend/mix)  (nullable) | symbol |\n| ------- | -------- | -------- | -------- | -------- | -------- |\n| Calories | 150 |  |  |  |  |\n| Total Fat | 5g | 6% |  |  |  |\n| Saturated Fat | 0g | 0% |  |  |  |\n| Trans Fat | 0g |  |  |  |  |\n| Cholesterol | 0mg | 0% |  |  |  |\n| Sodium | 660mg | 29% |  |  |  |\n| Total Carb. | 29g | 11% |  |  |  |\n| Dietary Fiber | 2g | 7% |  |  |  |\n| Total Sugars | 16g |  |  |  |  |\n| Added Sugars | 12g | 24% |  |  |  |\n| Protein | 6g |  |  |  |  |\n| Vitamin D | 0.2mcg | 2% |  |  |  |\n| Calcium | 60mg | 4% |  |  |  |\n| Iron | 1.5mg | 8% |  |  |  |\n| Potassium | 940mg | 20% |  |  |  |\n| Thiamin | 0.24mg | 20% |  |  |  |\n| Riboflavin (Vitamin B₂) | 1.11mg | 90% |  |  |  |\n| Niacin (Vitamin B₃) | 9.5mg | 60% |  |  |  |\n| Vitamin B₆ | 0.24mg | 15% |  |  |  |\n| Vitamin B₁₂ | 0.19mcg | 8% |  |  |  |\n\n# Footnote [1]\n| footnote symbol (nullable) | footnote content at bottom of nutrition fact (nullable) |\n| ------- | -------- |\n| * | * The % Daily Value (DV) tells you how much a nutrient in a serving of food contributes to a daily diet. 2,000 calories a day is used for general nutrition advice. |\n\n# Debug table\n| question | gemini answer |\n| ------- | -------- |\n| how many nutrition fact tables from provided images? are they the same one ? | There is 1 nutrition fact table in this image.  |\n`;
let result_6 = `Nutrition Fact for  [1]\n| Nutrient Name  | Amount per Serving | % Daily Value | parentheses descriptor (nullable) | blend ingredients (if nutrient is a blend/mix)  (nullable) | symbol |\n| ------- | -------- | -------- | -------- | -------- | -------- |\n| Calories | 15 |  |  |  |  |\n| Total Carbohydrate | 4g | 1% |  |  | * |\n| Dietary Fiber | 0g | 0% |  |  | * |\n| Total Sugars | 1g |  |  |  |  |\n| Includes Added Sugars | 0g | 0% |  |  | * |\n| Calcium | 8mg | 2% | ( as naturally occurring calcium ) |  | * |\n| Magnesium | 3.5mg | 1% | (as naturaly occuring magnesium) |  | * |\n| Chloride | 25mg | 5% | ( as naturally occurring chloride ) |  | * |\n| Sodium | 5mg | 0% | ( as naturally occurring sodium ) |  | * |\n| Potassium | 45mg | 1% | ( as naturally occuring potassium) |  | * |\n| Electrolyte / Hydration Support Blend | 3520mg |  |  | Organic Freeze Dried Coconut Water<br>Organic Lemon Juice<br>Organic Freeze Dried Strawberry Fruit<br>Organic Bamboo Extract<br>Organic Beet Root<br>Ocean Minerals derived from Aquamin , Marine Seaweed |  |\n\nHeader [1]\n| Serving Size | Equivalent Serving Size | Amount Per Serving name | Calories |\n| ------- | -------- | -------- | -------- |\n| 1 Stick | 4.2g | per serving |  |\n\nFootnote [1]\n| footnote symbol (nullable) | footnote content at bottom of nutrition fact (nullable) | footnote content in english only |\n| ------- | -------- | -------- |\n| * | Percent Daily Values are based on a 2,000 calorie diet .<br>** Daily Value not established . | Percent Daily Values are based on a 2,000 calorie diet .<br> Daily Value not established . |\n\nDebug table\n| question | gemini answer |\n| ------- | -------- |\n| gemini answer me  how many nutrition fact tables from provided images? are they the same one ? | 1, they are the same nutrition fact table, just from different angles. |\n| are they in dual-column format?  and tell me why? remember dual-column label format need to record as multiple nutrition fact markdown table | no. Although some nutrients are arranged in two columns to save space, they do not represent a true dual-column format.  True dual-column format typically involves separate columns for different serving sizes or different % Daily Values. |`;
let result_7 = `Nutrition Fact for  [1]\n| Nutrient Name  | Amount per Serving | % Daily Value | parentheses descriptor (nullable) | blend ingredients (if nutrient is a blend/mix)  (nullable) | symbol |\n| ------- | -------- | -------- | -------- | -------- | -------- |\n| Calories | 15 |  |  |  |  |\n| Total Carbohydrate | 4g | 1% |  |  | * |\n| Dietary Fiber | 0g | 0% |  |  | * |\n| Total Sugars | 1g |  |  |  |  |\n| Added Sugars | 0g | 0% | Includes 0g Added Sugars |  | * |\n| Calcium | 8mg | 2% | ( as naturally occurring calcium ) |  | * |\n| Magnesium | 3.5mg | 1% | as naturaly occuring magnesium |  | * |\n| Chloride | 25mg | 5% | ( as naturally occurring chloride ) |  | * |\n| Sodium | 5mg | 0% | ( as naturally occurring sodium ) |  | * |\n| Potassium | 45mg | 1% | ( as naturally occuring potassium |  | * |\n| Electrolyte / Hydration Support Blend | 3520mg |  |  | Organic Freeze Dried Coconut Water<br>Organic Lemon Juice<br>Organic Freeze Dried Strawberry Fruit<br>Organic Bamboo Extract<br>Organic Beet Root<br>Ocean Minerals derived from Aquamin , Marine Seaweed |  |\n\nHeader [1]\n| Serving Size | Equivalent Serving Size | Amount Per Serving name | Calories |\n| ------- | -------- | -------- | -------- |\n| 1 Stick | 4.2g | per serving |  |\n\nFootnote [1]\n| footnote symbol (nullable) | footnote content at bottom of nutrition fact (nullable) | footnote content in english only |\n| ------- | -------- | -------- |\n| * | Percent Daily Values are based on a 2,000 calorie diet .<br>** Daily Value not established . | Percent Daily Values are based on a 2,000 calorie diet .<br> Daily Value not established . |\n\nDebug table\n| question | gemini answer |\n| ------- | -------- |\n| gemini answer me  how many nutrition fact tables from provided images? are they the same one ? | 1 |\n| are they in dual-column format?  and tell me why? remember dual-column label format need to record as multiple nutrition fact markdown table | no |\n`;
let result_8 = `Nutrition Fact for [1]\n| Nutrient Name  | Amount per Serving  |  parentheses content explain for amount per serving | % Daily Value | parentheses content for nutrition name (nullable) (such as \"as something\") | blend ingredients (if nutrient is a blend/mix)  (nullable) | symbol |\n| ------- | -------- | -------- | -------- | -------- | -------- | -------- |\n| Total Fat | 23g |  | 29% |  |  |  |\n| Saturated Fat | 2g |  | 10% |  |  |  |\n| Trans Fat | 0g |  |  |  |  |  |\n| Cholesterol | 0mg |  | 0% |  |  |  |\n| Sodium | 270mg |  | 12% |  |  |  |\n| Total Carb. | 35g |  | 13% |  |  |  |\n| Dietary Fiber | 1g |  | 4% |  |  |  |\n| Total Sugars | 28g |  |  |  |  |  |\n| Added Sugars | 26g |  | 52% |  |  |  |\n| Protein | 3g |  |  |  |  |  |\n| Vitamin D | 0.1mcg |  | 0% |  |  |  |\n| Calcium | 10mg |  | 0% |  |  |  |\n| Iron | 0.3mg |  | 2% |  |  |  |\n| Potassium | 40mg |  | 0% |  |  |  |\nHeader [1]\n| Serving Per Container | Serving Size | Equivalent Serving Size | Amount Per Serving name | Calories |\n| ------- | -------- | -------- | -------- | -------- |\n| About 2.5 servings | 2/3 cup | (122g) | Per Serving | 360 |\nFootnote [1]\n| footnote symbol (nullable) | footnote content at bottom of nutrition fact (nullable) (include footnote symbol if avail) | footnote content in english only (nullable) (include footnote symbol if avail) |\n| ------- | -------- | -------- |\n| * | * The % Daily Value (DV) tells you how much a nutrient in a serving contributes to a daily diet. 2,000 calories a day is used for general nutrition advice. | * The % Daily Value (DV) tells you how much a nutrient in a serving contributes to a daily diet. 2,000 calories a day is used for general nutrition advice. |\nNutrition Fact for [2]\n| Nutrient Name  | Amount per Serving  |  parentheses content explain for amount per serving | % Daily Value | parentheses content for nutrition name (nullable) (such as \"as something\") | blend ingredients (if nutrient is a blend/mix)  (nullable) | symbol |\n| ------- | -------- | -------- | -------- | -------- | -------- | -------- |\n| Total Fat | 60g |  | 77% |  |  |  |\n| Saturated Fat | 6g |  | 30% |  |  |  |\n| Trans Fat | 0g |  |  |  |  |  |\n| Cholesterol | 0mg |  | 0% |  |  |  |\n| Sodium | 710mg |  | 31% |  |  |  |\n| Total Carb. | 93g |  | 34% |  |  |  |\n| Dietary Fiber | 1g |  | 4% |  |  |  |\n| Total Sugars | 69g |  |  |  |  |  |\n| Added Sugars | 69g |  | 138% |  |  |  |\n| Protein | 9g |  |  |  |  |  |\n| Vitamin D | 0.3mcg |  | 2% |  |  |  |\n| Calcium | 40mg |  | 4% |  |  |  |\n| Iron | 0.8mg |  | 4% |  |  |  |\n| Potassium | 100mg |  | 2% |  |  |  |\nHeader [2]\n| Serving Per Container | Serving Size | Equivalent Serving Size | Amount Per Serving name | Calories |\n| ------- | -------- | -------- | -------- | -------- |\n| About 2.5 servings | 2/3 cup | (122g) | Per Container | 940 |\nFootnote [2]\n| footnote symbol (nullable) | footnote content at bottom of nutrition fact (nullable) (include footnote symbol if avail) | footnote content in english only (nullable) (include footnote symbol if avail) |\n| ------- | -------- | -------- |\n| * | * The % Daily Value (DV) tells you how much a nutrient in a serving contributes to a daily diet. 2,000 calories a day is used for general nutrition advice. | * The % Daily Value (DV) tells you how much a nutrient in a serving contributes to a daily diet. 2,000 calories a day is used for general nutrition advice. |\nDebug table\n| question (question from debug list) | gemini answer |\n| ------- | -------- |\n| gemini answer me  how many nutrition fact tables from provided images? are they the same one ? | 1. They are the same. |\n| are they in dual-column format?  and tell me why? remember dual-column label format must be recorded as multiple nutrition fact markdown tables. I see you do not separated nutrition fact label to multiple nutrition fact table for dual-column format panel | Yes, it is in dual-column format. There are two columns for \"% Daily Value\" and two columns for different serving sizes. |\n`;
let result_9 = `NUTRITION_FACT_TABLE [1]\n| Nutrient Name  | parenthetical statement about nutrient name (nullable) | Amount per Serving  |  parenthetical statement about amount per serving | % Daily Value | blend ingredients (if nutrient is a blend/mix)  (nullable) | symbol symbol (such as *, **, †, ¥, ‡, †††, ...) (symbol could be next to Daily Value, or next to amount per serving) |\n| ------- | -------- | -------- | -------- | -------- | -------- | -------- |\n| Calories |  | 35 |  |  |  |  |\n| Calories |  | 70 |  |  |  |  |\n| Protein |  | 9 g |  |  |  |  |\n| Protein |  | 18 g |  |  |  |  |\n| Vitamin C | (from Lipid Metabolite Ascorbate) | 90 mg |  | 100% |  |  |\n| Vitamin C | (from Lipid Metabolite Ascorbate) | 180 mg |  | 200% |  |  |\n| Magnesium |  | 182 mg |  | 43% |  |  |\n| Magnesium |  | 364 mg |  | 86% |  |  |\n| Multi Collagen Beauty + Sleep Complex |  | 10.5g |  |  | Hydrolyzed Bovine Hide Collagen Peptides, Fermented Eggshell Membrane Collagen, Magnesium Hydroxide, Chicken Bone Broth Protein Concentrate, Pomegranate Fruit Extract, Bacillus coagulans (2 Billion CFU¹), Hydrolyzed Fish Collagen Peptides, Asparagus Shoot, Okra Pod, Coffee Fruit Extract, Japanese Sophora Flower, Acerola Cherry, Acai Berry, Mangosteen Fruit, Camu Camu Fruit. | + |\n| Multi Collagen Beauty + Sleep Complex |  | 21 g |  |  |  | + |\n\nHEADER_TABLE [1]\n| Serving Per Container | Serving Size | Equivalent Serving Size | Amount Per Serving name | Calories |\n| ------- | -------- | -------- | -------- | -------- |\n| 38 | 1 Scoop (12 g) |  |  |  |\n\nFOOTNOTE_TABLE [1]\n| footnote symbol (nullable) | footnote content at bottom of nutrition fact (nullable) (include footnote symbol if avail) | footnote content in english only (nullable) (include footnote symbol if avail) |\n| ------- | -------- | -------- |\n| + | † Daily Value not established. | † Daily Value not established. |\n\nDEBUG_TABLE\n| question (question from debug list) | gemini answer |\n| ------- | -------- |\n| gemini answer me  how many nutrition fact tables from provided images? are they the same one ? | There is only one nutrition facts table in the image. |\n| are they in dual-column format?  and tell me why? tell me why you create only one NUTRITION_FACT_TABLE for dual-column nutrition fact panel format ? remember dual-column label format must be recorded as multiple nutrition fact markdown tables. I see you do not separated nutrition fact label to multiple nutrition fact table for dual-column format panel | The nutrition facts table is in a dual-column format because it presents information for two different serving sizes: \"1 Scoop\" and \"2 Scoops.\"  I have recorded all the information in a single table to accurately reflect the structure of the provided nutrition facts label. |\n`;
let result_10 = `NUTRITION_FACT_TABLE [1]\n| Nutrient Name | parenthetical statement about nutrient name | Amount per Serving | parenthetical statement about amount per serving | % Daily Value | blend ingredients | symbol symbol (such as *, **, †, ¥, ‡, †††, ...) |\n|---|---|---|---|---|---|---|\n| Calories |  | 35 |  |  |  |  |\n| Protein |  | 9 g |  |  |  |  |\n| Vitamin C | (from Lipid Metabolite Ascorbate) | 90 mg |  | 100% |  |  |\n| Magnesium |  | 182 mg |  | 43% |  |  |\n| Multi Collagen Beauty + Sleep Complex |  | 10.5g |  |  | Hydrolyzed Bovine Hide Collagen Peptides, Fermented Eggshell Membrane Collagen, Magnesium Hydroxide, Chicken Bone Broth Protein Concentrate, Pomegranate Fruit Extract, Bacillus coagulans (2 Billion CFU¹), Hydrolyzed Fish Collagen Peptides, Asparagus Shoot, Okra Pod, Coffee Fruit Extract, Japanese Sophora Flower, Acerola Cherry, Acai Berry, Mangosteen Fruit, Camu Camu Fruit. | + |\n\nHEADER_TABLE [1]\n| Serving Per Container | Serving Size | Equivalent Serving Size | Amount Per Serving name | Calories |\n|---|---|---|---|---|\n| 38 | 1 Scoop (12 g) |  |  |  |\n\nFOOTNOTE_TABLE [1]\n| footnote symbol | footnote content at bottom of nutrition fact | footnote content in english only |\n|---|---|---|\n| + | Daily Value not established. | Daily Value not established. |\n\nNUTRITION_FACT_TABLE [2]\n| Nutrient Name | parenthetical statement about nutrient name | Amount per Serving | parenthetical statement about amount per serving | % Daily Value | blend ingredients | symbol symbol (such as *, **, †, ¥, ‡, †††, ...) |\n|---|---|---|---|---|---|---|\n| Calories |  | 70 |  |  |  |  |\n| Protein |  | 18 g |  |  |  |  |\n| Vitamin C | (from Lipid Metabolite Ascorbate) | 180 mg |  | 200% |  |  |\n| Magnesium |  | 364 mg |  | 86% |  |  |\n| Multi Collagen Beauty + Sleep Complex |  | 21 g |  |  | Hydrolyzed Bovine Hide Collagen Peptides, Fermented Eggshell Membrane Collagen, Magnesium Hydroxide, Chicken Bone Broth Protein Concentrate, Pomegranate Fruit Extract, Bacillus coagulans (2 Billion CFU¹), Hydrolyzed Fish Collagen Peptides, Asparagus Shoot, Okra Pod, Coffee Fruit Extract, Japanese Sophora Flower, Acerola Cherry, Acai Berry, Mangosteen Fruit, Camu Camu Fruit. | + |\n\nHEADER_TABLE [2]\n| Serving Per Container | Serving Size | Equivalent Serving Size | Amount Per Serving name | Calories |\n|---|---|---|---|---|\n| 38 | 1 Scoop (12 g) |  |  |  |\n\nFOOTNOTE_TABLE [2]\n| footnote symbol | footnote content at bottom of nutrition fact | footnote content in english only |\n|---|---|---|\n| + | Daily Value not established. | Daily Value not established. |\n\nDEBUG_TABLE\n| question | gemini answer |\n|---|---|\n| gemini answer me  how many nutrition fact tables from provided images? are they the same one ? | There is one nutrition fact table in the image. |\n| are they in dual-column format?  and tell me why? tell me why you create only one nutrition fact table for dual-column nutrition fact panel format ? remember dual-column label format must be recorded as multiple nutrition fact markdown tables. I see you do not separated nutrition fact label to multiple nutrition fact table for dual-column format panel | This nutrition label is in a dual-column format because it presents the nutritional information for two different serving sizes: \"1 Scoop\" and \"2 Scoops\".  I have separated the information into two tables to reflect the dual-column format. |\n`;

const { headers } = require('next/headers.js');
const logger = require('./src/lib/logger/index.js');

let parse2 = (markdown) => {
  const nutritionSections = markdown.split('NUTRITION_FACT_TABLE').slice(1);
  return nutritionSections.map((section) => {
    const [nutrientSection, headerToRest] = section.split('HEADER_TABLE');
    const [nutHeader, footnoteToRest] = headerToRest.split('FOOTNOTE_TABLE');
    const [footnoteSection, debugSection] = footnoteToRest.split('DEBUG_TABLE');
    logger.error('debug section');
    logger.info(debugSection);

    const [headerTitle, ...nutritionLines] = nutrientSection
      .trim()
      .split('\n')
      .filter((line) => line.trim().length > 0);

    const nutrients = nutritionLines
      .slice(2)
      .map((line) => {
        const [
          nutrientName,
          parenthesesDescriptor,
          amountPerServing,
          amountPerServingDescriptor,
          dailyValue,
          blendIngredients,
          symbol,
        ] = line
          .split('|')
          .filter((item) => item !== '')
          .map((item) => item.trim());

        return {
          nutrientName,
          parenthesesDescriptor: parenthesesDescriptor || null,
          amountPerServing,
          amountPerServingDescriptor,
          dailyValue,
          blendIngredients: blendIngredients || null,
          symbol: symbol || null,
        };
      })
      .filter((nutrient) => nutrient.nutrientName !== '-------');

    console.log('nut header --', JSON.stringify(nutHeader));

    const headerLines = nutHeader
      .trim()
      .split('\n')
      .filter((item) => item !== '')
      .slice(3)
      .map((line) =>
        line
          .split('|')
          .filter((item) => item !== '')
          .map((item) => item.trim())
      );

    const [
      servingPerContainer,
      servingSize,
      equivalentServingSize,
      amountPerServingName,
      calories,
    ] = headerLines[0];

    let servingInfo = {
      servingPerContainer,
      servingSize,
      equivalentServingSize,
      amountPerServingName,
      calories,
    };

    logger.error('footnote');
    logger.info(footnoteSection);

    const footnoteLines = footnoteSection
      .trim()
      .split('\n')
      .filter((item) => item !== '')
      .slice(3)
      .filter((line) => line.trim().length > 0);

    const footnoteData = footnoteLines.map((line) => {
      const [footnoteSymbol, footnoteContent, footnoteContentEnglish] = line
        .split('|')
        .filter((item) => item !== '')
        .map((item) => item.trim());

      return {
        footnoteSymbol: footnoteSymbol || null,
        footnoteContent: footnoteContent || null,
        footnoteContentEnglish: footnoteContentEnglish || null,
      };
    });

    let debugTable;

    logger.error('debug');
    logger.info(debugSection);

    if (debugSection) {
      const debugLines = debugSection
        .trim()
        .split('\n')
        .filter((item) => item !== '')
        .slice(1)
        .filter((line) => line.trim().length > 0);

      debugTable = debugLines.map((line) => {
        const [question, geminiAnswer] = line
          .split('|')
          .filter((item) => item !== '')
          .map((item) => item.trim());
        return {
          question,
          geminiAnswer,
        };
      });
    }

    logger.error('debug table');
    logger.info(debugTable);

    let result = {
      title: headerTitle.trim(),
      servingInfo,
      nutritionFacts: nutrients,
      footnotes: footnoteData,
      // debugTable,
    };

    if (debugTable) {
      result = { ...result, debugTable: debugTable };
    }

    console.log('result ---', JSON.stringify(result));

    return result;
  });
};

let final = parse2(result_10);
